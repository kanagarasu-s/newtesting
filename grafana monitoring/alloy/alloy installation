# alloy install on ubuntu 24.04
================================

# import the GPG KEY and add the Grafana package repository.

sudo mkdir -p /etc/apt/keyrings/
wget -q -O - https://apt.grafana.com/gpg.key | gpg --dearmor | sudo tee /etc/apt/keyrings/grafana.gpg > /dev/null
echo "deb [signed-by=/etc/apt/keyrings/grafana.gpg] https://apt.grafana.com stable main" | sudo tee /etc/apt/sources.list.d/grafana.list

# update the repositories.

sudo apt-get update

# install alloy.

sudo apt-get install alloy

# to start alloy, run the following command in a terminal

sudo systemctl start alloy

# to automatically run alloy when the system starts, run the following command in a terminal.

sudo systemctl enable alloy.service

# to verify that the service is running, run the following command in a termainal.

sudo systemctl status alloy

# to restart alloy, run the following command in a terminal.

sudo systemctl restart alloy

# to stop alloy, run the following command in a terminal.

sudo systemctl stop alloy

# to view alloy log files, run the following command in a terminal.

sudo journalctl -u alloy

# to configure, add user root run the following command in a terminal

[Unit]
Description= Vendor-agnostic OpenTelemetry Collector distribution with programmable pipelines
Documentation=https://grafana.com/docs/alloy
Wants=network-online.target
After=network-online.target

[Service]
Restart=always
User=root
Environment=HOSTNAME=%H
Environment=ALLOY_DEPLOY_MODE=deb
EnvironmentFile=/etc/default/alloy
WorkingDirectory=/var/lib/alloy
ExecStart=/usr/bin/alloy run $CUSTOM_ARGS --storage.path=/var/lib/alloy/data $CONFIG_FILE
ExecReload=/usr/bin/env kill -HUP $MAINPID
TimeoutStopSec=20s
SendSIGKILL=no

[Install]
WantedBy=multi-user.target






